{"ts":1341592137449,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/**\n * NodeJS CommonJS boilerplate for in-browser module use\n *  By default, this script assumes all js files in the same directory as it,\n *   as well as all subdirectories are modules.\n *  Modules.script(name) returns the necessary script tags to make the module available in the web app\n *  Modules.module(name) returns the module code, including all boilerplate code necessary\n *\n *  When this script is called from the command line Modules.module(name) is output\n *   node ./modules.js [name] [config_file]; # both arguments are optional, config_file must have a .config.json extension\n *\n * Copyright 2011, Andy VanWagoner\n * Released under the MIT License.\n **/\nvar Modules = {\n\n\t/**\n\t * Gets the default options used when you don't specify an option.\n\t *  Defaults are loaded from the modules.config.json file\n\t **/\n\tgetDefaultOptions: function getDefaultOptions(fn) {\n\t\tif (!default_opts) {\n\t\t\tdefault_opts = {\n\t\t\t\tmod_dir:  __dirname.replace(/\\\\/g, '/'),\n\t\t\t\tsrc_url:  '/js/modules.js',\n\t\t\t\tseparate: false,\n\t\t\t\tindent:   '\t',\n\t\t\t\theaders:  { 'Content-Type':true, 'Expires':'+30 days', 'Last-Modified':true },\n\t\t\t\tcompress: false,\n\t\t\t\trequire:  __dirname+'/modules.require.js'\n\t\t\t};\n\t\t\tModules.loadDefaultOptions(__dirname+'/modules.config.json', fn);\n\t\t}\n\t},\n\n\t/**\n\t * Sets the default options used when you don't specify an option.\n\t **/\n\tsetDefaultOptions: function setDefaultOptions(opts) {\n\t\tvar default_opts = Modules.getDefaultOptions(), key;\n\t\tfor (key in opts) {\n\t\t\tif (key in default_opts) { default_opts[key] = opts[key]; }\n\t\t}\n\t},\n\n\t/**\n\t * Loads default options from a config file\n\t **/\n\tloadDefaultOptions: function loadDefaultOptions(file, fn) {\n\t\tfunction loadOpts(err, json) {\n\t\t\tif (err) { throw err; }\n\t\t\tjson = json.replace(/^\\/\\/[^\\n]*\\n|\\n\\/\\/[^\\n]*/g, '') // strip comments\n\t\t\t\t.replace(/,\\s*}/g, '}'); // don't let trailing commas bother\n\t\t\tif (json = JSON.parse(json)) { Modules.setDefaultOptions(json); }\n\t\t\tif (fn) { fn(); }\n\t\t}\n\t\tvar fs = require('fs');\n\t\tif (fn) { fs.readFile(file, 'utf8', loadOpts); }\n\t\telse { loadOpts(null, fs.readFileSync(file, 'utf8')); }\n\t},\n\n\t/**\n\t * Returns the script tags required to use CommonJS modules in the browser\n\t * @param name name of the module - must be a Modules 1.1.1 top-level module identifier\n\t *  if name is falsy, tags for all modules in the root modules folder are output\n\t *  if name resolves to a folder, tags for all modules in that folder are output\n\t * @param array opts options influencing how the modules are found, and how the tags are printed\n\t *  indent - a whitespace string to print before each script tag\n\t *  src_url - the url where browser retrieves the modules\n\t *  separate - if true, each module will be in it's own script tag, defaults to false\n\t **/\n\tscript: function script(name, opts, fn) {\n\t\topts = getOptions(opts);\n\t\tvar ind = opts.indent, src = opts.src_url,\n\t\t\tmodules, filename, out = '';\n\t\tif (opts.separate) {\n\t\t\tmodules = getModules(name, opts);\n\t\t\tfor (name in modules) {\n\t\t\t\tout += ind+'<script src=\"'+src+'/'+name+'\"></script>\\n';\n\t\t\t}\n\t\t} else {\n\t\t\tout = ind+'<script src=\"'+src+(name?'':'/'+name)+'\"></script>\\n';\n\t\t}\n\t\treturn out;\n\t},\n\n\t/**\n\t * Returns the code for the module(s), including boilerplate code necessary in the browser.\n\t * @param name name of the module - must be a Modules 1.1.1 top-level module identifier\n\t *  if name is falsy, all modules in the root modules folder are output\n\t *  if name resolves to a folder, all modules in that folder are output\n\t * @param array opts options influencing how the module name is resolved, and how the code is printed\n\t *  mod_dir - specifies the root modules folder (no trailing slash)\n\t *  compress - specifies a function to compress the javascript code, or false to not compress\n\t *   the function specified must take the uncompressed code as the first parameter, and return the compressed code\n\t *  headers - The headers sent (only if return is false)\n\t **/\n\tmodule: function module(name, opts) {\n\t\topts = getOptions(opts);\n\t\tvar modules = getModules(name, opts),\n\t\t\tout = '', last = 0;\n\n\t\tif (!name && opts.require) { // define require if all modules\n\t\t\tout .= self::printRequire(opts);\n\t\t\tlast = filemtime(opts['require']);\n\t\t}\n\t\tforeach (modules as name => filename) {\n\t\t\tout .= self::printModule($name, $filename, $opts);\n\t\t\tlast = max(last, filemtime(filename));\n\t\t}\n\n\t\tcompress =& opts['compress'];\n\t\tif (!empty(compress['function'])) {\n\t\t\tif (!empty(compress['include'])) @include_once compress['include'];\n\t\t\tcompressed = call_user_func(compress['function'], out);\n\t\t\tif (compressed) out = compressed;\n\t\t}\n\n\t\theaders =& opts['headers'];\n\t\tif (!opts['return'] && !empty(headers) && is_array(headers)) {\n\t\t\tif (!empty(headers['Content-Type']))\n\t\t\t\theader('Content-Type: '.(is_string(headers['Content-Type']) ? headers['Content-Type'] : 'text/javascript'));\n\t\t\tif (!empty(headers['Last-Modified']))\n\t\t\t\theader('Last-Modified: '.gmdate('D, d M Y H:i:s', last).' GMT');\n\t\t\tif (!empty(headers['Expires']))\n\t\t\t\theader('Expires: '.gmdate('D, d M Y H:i:s', strtotime(headers['Expires'])).' GMT');\n\t\t}\n\n\t\tif (opts['return']) return out;\n\t\telse echo out;\n\t}\n}, default_opts = null;\n\nfunction getOptions(opts) {\n\tvar default_opts = Modules.getDefaultOptions();\n\treturn {\n\t\t'mod_dir'  => empty(opts['mod_dir'])   ? default_opts['mod_dir']  : opts['mod_dir'],\n\t\t'return'   => !isset(opts['return'])   ? default_opts['return']   : opts['return'],\n\t\t'src_url'  => empty(opts['src_url'])   ? default_opts['src_url']  : opts['src_url'],\n\t\t'separate' => !isset(opts['separate']) ? default_opts['separate'] : opts['separate'],\n\t\t'indent'   => !isset(opts['indent'])   ? default_opts['indent']   : opts['indent'],\n\t\t'headers'  => !isset(opts['headers'])  ? default_opts['headers']  : opts['headers'],\n\t\t'compress' => !isset(opts['compress']) ? default_opts['compress'] : opts['compress'],\n\t\t'require'  => empty(opts['require'])   ? default_opts['require']  : opts['require']\n\t};\n}\n\nfunction getModules(name, opts) {\n\tmodules = array();\n\tmod_dir = opts['mod_dir'];\n\tprefix = strlen(mod_dir)+1;\n\tfiles = array();\n\tif (name) {\n\t\tif (!preg_match('/^\\w+(?:\\/\\w+)*/', name)) throw new Exception('\"'.name.'\" is not a valid Modules 1.1.1 top-level module identifier', 1);\n\t\tfilename = mod_dir.'/'.name.'.js';\n\t\tif (!is_file(filename) || !is_readable(filename)) {\n\t\t\tfilename = opts['mod_dir'].'/'.name; // not a module, try a folder\n\t\t\tif (!is_dir(filename) || !is_readable(filename)) throw new Exception('Module \"'.name.'\" could not resolve to a readable file', 2);\n\t\t}\n\t\tfiles[] = filename;\n\t} else { // include all modules\n\t\tfiles[] = mod_dir;\n\t}\n\tvisited = array();\n\twhile (!empty(files)) {\n\t\tfile = array_pop(files);\n\n\t\t// prevent infinite looping from circular links\n\t\treal = realpath(file);\n\t\tif (visited[real]) continue;\n\t\tvisited[real] = true;\n\n\t\t// depth-first traveral of directories\n\t\tif (is_dir(file)) {\n\t\t\tif (!(dir = opendir(file))) continue;\n\t\t\twhile ((sub = readdir(dir)) !== false) {\n\t\t\t\tif (sub{0} === '.') continue;\n\t\t\t\tsubf = file.'/'.sub;\n\t\t\t\tif ((preg_match('/^\\w+\\.js/i', sub) || is_dir(subf)) && is_readable(subf)) files[] = subf;\n\t\t\t}\n\t\t\tclosedir(dir);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// convert filename to name\n\t\tname = substr(file, prefix, -3); // remove mod_dir prefix and .js suffix\n\t\tmodules[name] = file;\n\t}\n\treturn modules;\n}\n\nfunction printModule(name, filename, opts) {\n\treturn \"/* ==MODULE== name */\"\n\t\t.\"require.define('name',function(module,exports){\\n\"\n\t\t\t.file_get_contents(filename)\n\t\t.\"\\n/* ==ENDMODULE== name */});\\n\";\n}\n\nfunction printRequire(opts) {\n\treturn file_get_contents(opts['require']);\n}\n\nexports.Modules = Modules;\n\n\n// command line use\nif (require.main === module) {\n\tvar name = process.argv[2],\n\t\tconfig = process.argv[3];\n\tif (name.slice(-12) === '.config.json') {\n\t\tconfig = name;\n\t\tname = null;\n\t}\n\tif (config) { Modules.loadDefaultOptions(config); }\n\tModules.module(name, { return:false });\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":7902}]],"length":7902}
{"contributors":[],"silentsave":false,"ts":1351369779339,"patch":[[{"diffs":[[0,"\n * "],[-1,"NodeJS CommonJS boilerplate for in-browser module use\n *  By default, this script assumes all js files in the same directory as it,\n *   as well as all subdirectories are modules.\n *  Modules.script(name) returns the necessary script tags to make the module available in the web app\n *  Modules.module(name) returns the module code, including all boilerplate code necessary\n *\n *  When this script is called from the command line Modules.module(name) is output\n *   node ./modules.js [name] [config_file]; # both arguments are optional, config_file must have a .config.json extension\n *\n * Copyright 2011, Andy VanWagoner\n * Released under the MIT License.\n **/\nvar Modules = {\n\n\t/**\n\t * Gets the default options used when you don't specify an option.\n\t *  Defaults are loaded from the modules.config.json file\n\t **/\n\tgetDefaultOptions: "],[1,"Provides wrapping of modules for use in the browser.\n **/\n\"use strict\";\n\nvar fs = require('fs'), path = require('path'), extexp = /\\.(\\w+)$/;\n\nfunction translate(name, uri, content, opts) {\n\tvar ext = uri.match(extexp)[1];\n\tif (opts.translate[ext]) return opts.translate[ext](name, uri, content, opts);\n\tif ('js' === ext) return content;\n\tif ('json' === ext) return 'module.exports = ' + content;\n\treturn 'module.exports = ' + JSON.stringify(content); // export file as json string\n}\n\nfunction getUri(id, opts) {\n\tvar uri = opts.map[id] || id, f, ff = opts.forbid, forbid;\n\turi = path.resolve(opts.root, uri) + (extexp.test(uri) ? '' : '.js');\n\tfor (f = 0; f < ff; ++f) {\n\t\tforbid = opts.forbid[f];\n\t\tif (uri.slice(0, forbid.length) === forbid) return '';\n\t}\n\treturn uri;\n}\n\n"],[0,"func"]],"start1":3,"start2":3,"length1":845,"length2":783},{"diffs":[[0," get"],[-1,"Default"],[0,"Options("],[-1,"fn"],[1,"opts"],[0,") {\n\t"],[-1,"\tif (!default_opts) {\n\t\t\tdefault_opts = {\n\t\t\t\tmod_dir:  __dirname.replace(/\\\\/g, '/'),\n\t\t\t\tsrc_url:  '/js/modules.js',\n\t\t\t\tseparate: false,\n\t\t\t\tindent:   '\t',\n\t\t\t\theaders:  { 'Content-Type':true, 'Expires':'+30 days', 'Last-Modified':true },\n\t\t\t\tcompress: false,\n\t\t\t\t"],[1,"opts = opts || {};\n\topts.root = opts.root || __dirname;\n\topts.path = opts.path || '/module/';\n\topts.maxAge = opts.maxAge || 0;\n\topts.compress = opts.compress || false;\n\topts.map = opts.map || {};\n\topts.map.require = opts.map."],[0,"require"],[-1,":"],[0," "],[1,"||"],[0," __d"]],"start1":790,"start2":790,"length1":306,"length2":260},{"diffs":[[0,"name"],[-1,"+'/modules.require.js'\n\t\t\t};\n\t\t\tModules.loadDefaultOptions(__dirname+'/modules.config.json', fn);\n\t\t}\n\t},\n\n\t/**\n\t * Sets the default options used when you don't specify an option.\n\t **/\n\tsetDefaultOptions: function setDefaultOptions(opts) {\n\t\tvar default_opts = Modules.getDefaultOptions(), key;\n\t\tfor (key in opts) {\n\t\t\tif (key in default_opts) { default_opts[key] = opts[key]; }\n\t\t}\n\t},\n\n\t"],[1," + '/require';\n\topts.translate = opts.translate || {};\n\topts.forbid = (opts.forbid || []).map(function(p) {\n\t\treturn path.resolve(opts.root, p);\n\t});\n\treturn opts;\n}\n\n"],[0,"/**\n"],[-1,"\t"],[0," * "],[-1,"Loads default options from a config file\n\t **/\n\tloadDefaultOptions: function loadDefaultOptions(file, fn) {\n\t\tfunction loadOpts(err, json"],[1,"Prints the code for the module, including boilerplate code necessary in the browser.\n **/\nfunction module(id, opts, next"],[0,") {\n"],[-1,"\t\t"],[0,"\tif ("],[-1,"err) { throw err; }\n\t\t\tjson = json.replace(/^\\/\\/[^\\n]*\\n|\\n\\/\\/[^\\n]*/g, '') // strip comments\n\t\t\t\t.replace(/,\\s*}/g, '}'); // don't let trailing commas bother\n\t\t\tif (json = JSON.parse(json)) { Modules.setDefaultOptions(json); }\n\t\t\tif (fn) { fn(); }\n\t\t}\n\t\tvar fs = require('fs');\n\t\tif (fn) { fs.readFile(file, 'utf8', loadOpts); }\n\t\telse { loadOpts(null, fs.readFileSync(file, 'utf8')); }\n\t},\n\n\t/**\n\t * Returns the script tags required to use CommonJS modules in the browser\n\t * @param name name of the module - must be a Modules 1.1.1 top-level module identifier\n\t *  if name is falsy, tags for all modules in the root modules folder are output\n\t *  if name resolves to a folder, tags for all modules in that folder are output\n\t * @param array opts options influencing how the modules are found, and how the tags are printed\n\t *  indent - a whitespace string to print before each script tag\n\t *  src_url - the url where browser retrieves the modules\n\t *  separate - if true, each module will be in it's own script tag, defaults to false\n\t **/\n\tscript: function script(name, opts, fn) {\n\t\topts = getOptions(opts);\n\t\tvar ind = opts.indent, src = opts.src_url,\n\t\t\tmodules, filename, out = '';\n\t\tif (opts.separate) {\n\t\t\tmodules = getModules(name, opts"],[1,"id.slice(-3) === '.js') id = id.slice(0, -3);\n\topts = getOptions(opts);\n  if ('bundles' === id && opts.bundles) { return bundles(opts, next); }\n\tvar uri = getUri(id, opts);\n\tfs.stat(uri, function(err, stat) {\n\t\tif (err) return next(err);\n\t\tfs.readFile(uri, 'utf8', function(err, content) {\n\t\t\tif (err) return next(err);\n\t\t\tif (id !== 'require') {\n\t\t\t\tcontent = translate(id, uri, content, opts);\n\t\t\t\tcontent = 'define(' + JSON.stringify(id) +\n\t\t\t\t\t',function(require,exports,module){' + content + '\\n});\\n';\n\t\t\t}\n\t\t\tif (opts.compress) {\n\t\t\t\topts.compress(content, function(err, content) {\n\t\t\t\t\tif (err) return next(err"],[0,");\n\t\t\t"],[-1,"for (name in modules) {\n\t\t\t\tout += ind+'<script src=\"'+src+'/'+name+'\"></script>\\n';\n\t\t\t}\n\t\t} else {\n\t\t\tout = ind+'<script src=\"'+src+(name?'':'/'+name)+'\"></script>\\n'"],[1,"\t\tnext(null, content, stat.mtime);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tnext(null, content, stat.mtime)"],[0,";\n"],[1,"\t"],[0,"\t\t}\n\t\t"],[-1,"return out;\n\t},"],[1,"});\n\t});\n}"],[0,"\n\n"],[-1,"\t"],[0,"/**\n"],[-1,"\t"],[0," * "],[-1,"Return"],[1,"Print"],[0,"s th"]],"start1":1052,"start2":1052,"length1":2018,"length2":1058},{"diffs":[[0,"dule"],[-1,"(s)"],[1,"s"],[0,", in"]],"start1":2127,"start2":2127,"length1":11,"length2":9},{"diffs":[[0,"er.\n"],[-1,"\t"],[0," *"],[-1," @param name name of the module - must be a Modules 1.1.1 top-level module identifier\n\t *  if name is falsy, all modules in the root modules folder are output\n\t *  if name resolves to a folder, all modules in that folder are output\n\t * @param array opts options influencing how the module name is resolved, and how the code is printed\n\t *  mod_dir - specifies the root modules folder (no trailing slash)\n\t *  compress - specifies a function to compress the javascript code, or false to not compress\n\t *   the function specified must take the uncompressed code as the first parameter, and return the compressed code\n\t *  headers - The headers sent (only if return is false)\n\t **/\n\tmodule: function module(name, opts) {\n\t\topts = getOptions(opts);\n\t\tvar modules = getModules(name, opts),\n\t"],[1,"*/\nfunction modules(modules, opts, next) {\n\tvar modified = new Date(0), error,\n\t\tlength = modules.length, m = 0,\n\t\tout = '';\n\n\topts = getOptions(opts);\n\tvar compressfn = opts.compress;\n\topts.compress = null; // don't compress each individually\n\n\tfunction loop() { // append each module\n\t\tif (m < length) return module(modules[m++], opts, append);\n\t\tif (!compressfn) return next(null, out, modified);\n\t\tcompressfn(out, function(err, out) {\n\t\t\tif (err) return next(err);\n\t\t\tnext(null, out, modified);\n\t\t});\n\t}\n\n\tfunction append(err, content, mod) {\n\t\tif (err) return next(err);\n"],[0,"\t\tout "],[1,"+"],[0,"= "],[-1,"'', last = 0;\n\n\t\tif (!name && opts.require) { // define require if all modules\n\t\t\tout .= self::printRequire(opts);\n\t\t\tlast = filemtime(opts['require']);\n\t\t}\n\t\tforeach (modules as name => filename) {\n\t\t\tout .= self::printModule($name, $filename, $opts);\n\t\t\tlast = max(last, filemtime(filename));\n\t\t}\n\n\t\tcompress =& opts['compress'];\n\t\tif (!empty(compress['function'])) {\n\t\t\tif (!empty(compress['include'])) @include_once compress['include'];\n\t\t\tcompressed = call_user_func(compress['function'], out);\n\t\t\tif (compressed) out = compressed;\n\t\t}\n\n\t\theaders =& opts['headers'];\n\t\tif (!opts['return'] && !empty(headers) && is_array(headers)) {\n\t\t\tif (!empty(headers['Content-Type']))\n\t\t\t\theader('Content-Type: '.(is_string(headers['Content-Type']) ? headers['Content-Type'] : 'text/javascript'));\n\t\t\tif (!empty(headers['Last-Modified']))\n\t\t\t\theader('Last-Modified: '.gmdate('D, d M Y H:i:s', last).' GMT');\n\t\t\tif (!empty(headers['Expires']))\n\t\t\t\theader('Expires: '.gmdate('D, d M Y H:i:s', strtotime(headers['Expires'])).' GMT');\n\t\t}\n\n\t\tif (opts['return']) return out;\n\t\telse echo out;\n\t}\n}, default_opts = null;\n\nfunction getOptions(opts) {\n\tvar default_opts = Modules.getDefaultOptions();\n\treturn {\n\t\t'mod_dir'  => empty(opts['mod_dir'])   ? default_opts['mod_dir']  : opts['mod_dir'],\n\t\t'return'   => !isset(opts['return'])   ? default_opts['return']   : opts['return'],\n\t\t'src_url'  => empty(opts['src_url'])   ? default_opts['src_url']  : opts['src_url'],\n\t\t'separate' => !isset(opts['separate']) ? default_opts['separate'] : opts['separate'],\n\t\t'indent'   => !isset(opts['indent'])   ? default_opts['indent']   : opts['indent'],\n\t\t'headers'  => !isset(opts['headers'])  ? default_opts['headers']  : opts['headers'],\n\t\t'compress' => !isset(opts['compress']) ? default_opts['compress'] : opts['compress'],\n\t\t'require'  => empty(opts['require'])   ? default_opts['require']  : opts['require']\n\t};\n}\n\nfunction getModules(name, opts) {\n\tmodules = array();\n\tmod_dir = opts['mod_dir'];\n\tprefix = strlen(mod_dir)+1;\n\tfiles = array();\n\tif (name) {\n\t\tif (!preg_match('/^\\w+(?:\\/\\w+)*/', name)) throw new Exception('\"'.name.'\" is not a valid Modules 1.1.1 top-level module identifier', 1);\n\t\tfilename = mod_dir.'/'.name.'.js';\n\t\tif (!is_file(filename) || !is_readable(filename)) {\n\t\t\tfilename = opts['mod_dir'].'/'.name; // not a module, try a folder\n\t\t\tif (!is_dir(filename) || !is_readable(filename)) throw new Exception('Module \"'.name.'\" could not resolve to a readable file', 2);\n\t\t}\n\t\tfiles[] = filename;\n\t} else { // include all modules\n\t\tfiles[] = mod_dir;\n\t}\n\tvisited = array();\n\twhile (!empty(files)) {\n\t\tfile = array_pop(files);\n\n\t\t// prevent infinite looping from circular links\n\t\treal = realpath(file);\n\t\tif (visited[real]) continue;\n\t\tvisited[real] = true;\n\n\t\t// depth-first traveral of directories\n\t\tif (is_dir(file)) {\n\t\t\tif (!(dir = opendir(file))) continue;\n\t\t\twhile ((sub = readdir(dir)) !== false) {\n\t\t\t\tif (sub{0} === '.') continue;\n\t\t\t\tsubf = file.'/'.sub;\n\t\t\t\tif ((preg_match('/^\\w+\\.js/i', sub) || is_dir(subf)) && is_readable(subf)) files[] = subf;\n\t\t\t}\n\t\t\tclosedir(dir);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// convert filename to name\n\t\tname = substr(file, prefix, -3); // remove mod_dir prefix and .js suffix\n\t\tmodules[name] = file;\n\t}\n\treturn modules;\n}\n\nfunction printModule(name, filename, opts) {\n\treturn \"/* ==MODULE== name */\"\n\t\t.\"require.define('name',function(module,exports){\\n\"\n\t\t\t.file_get_contents(filename)\n\t\t.\"\\n/* ==ENDMODULE== name */});\\n\";\n}\n\nfunction printRequire(opts) {\n\treturn file_get_contents(opts['require']);\n}\n\nexports.Modules = Modules;\n\n\n// command line use\nif (require.main === module) {\n\tvar name = process.argv[2],\n\t\tconfig = process.argv[3];\n\tif (name.slice(-12) === '.config.json') {\n\t\tconfig = name;\n\t\tname = null;\n\t}\n\tif (config) { Modules.loadDefaultOptions(config); }\n\tModules.module(name, { return:false });\n}"],[1,"content;\n\t\tif (mod > modified) modified = mod;\n\t\tloop();\n\t}\n\n\tif ('require' !== modules[0]) {\n\t\tout += // allow this package to be before require.js\n\t\t\t'if (!this.define) { this.define = (function() {\\n' +\n\t\t\t'\tfunction define(id, fn) { defs[id] = fn; }\\n' +\n\t\t\t'\tvar defs = define.defs = {};\\n' +\n\t\t\t'\treturn define;\\n' +\n\t\t\t'}()); }\\n\\n';\n\t}\n\tloop();\n}\n\n/**\n * Finds all the module's nested dependencies and provides the ids as an array\n *  id can be a string or an array of absolute module id strings\n **/\nfunction dependencies(id, opts, next) {\n\topts = getOptions(opts);\n\tvar stack = [].concat(id), list = [].concat(id),\n\t\treqexp = /\\brequire\\s*\\(\\s*(['\"]).+?\\1\\s*\\)/g,\n\t\tidexp = /(['\"])(.+?)\\1/, ext = '.js';\n\n\tfunction resolve(id, base) {\n\t\tif (id.slice(-ext.length) === ext) { id = id.slice(0, -ext.length); }\n\t\tif (id.charAt(0) === '.') { id = base.replace(/\\w+$/, id); }\n\t\tvar orig = id.split('/'), terms = [], i, l = orig.length;\n\t\tfor (i = 0; i < l; ++i) {\n\t\t\tif (orig[i] === '..') { terms.pop(); }\n\t\t\telse if (orig[i] !== '.') { terms[terms.length] = orig[i]; }\n\t\t}\n\t\treturn terms.join('/');\n\t}\n\n\tfunction loop() {\n\t\tif (!stack.length) return next(null, list);\n\t\tvar id = stack.pop(), uri = getUri(id, opts);\n\t\tfs.readFile(uri, 'utf8', function(err, content) {\n\t\t\tif (err) {\n\t\t\t\tif ('ENOENT' === err.code) {\n\t\t\t\t\tlist.splice(list.indexOf(id), 1);\n\t\t\t\t\treturn loop();\n\t\t\t\t} else { return next(err); }\n\t\t\t}\n\t\t\tcontent = translate(id, uri, content, opts);\n\t\t\tvar matches = content.match(reqexp),\n\t\t\t\tm, mm = matches && matches.length;\n\t\t\tfor (m = 0; m < mm; ++m) {\n\t\t\t\tvar rid = resolve(matches[m].match(idexp)[2], id);\n\t\t\t\tif (!~list.indexOf(rid)) {\n\t\t\t\t\tlist[list.length] = stack[stack.length] = rid;\n\t\t\t\t}\n\t\t\t}\n\t\t\tloop();\n\t\t});\n\t}\n\tloop();\n}\n\n/**\n * Provides middleware to format module code for use in the browser.\n **/\nfunction middleware(opts) {\n\topts = getOptions(opts);\n\tvar path = opts.path, deps = /\\/dependencies\\.json$/i;\n\n\treturn function(req, res, next) {\n\t\tif (req.path.slice(0, path.length) !== path) return next();\n\t\tvar id = req.path.slice(path.length);\n\n\t\tif (deps.test(id)) {\n\t\t\tdependencies(id.replace(deps, ''), opts, function(err, content) {\n\t\t\t\tif (err) return 'ENOENT' === err.code ? next() : next(err);\n\t\t\t\tres.set('Content-Type', 'application/json');\n\t\t\t\tres.set('Cache-Control', 'public, max-age=' + opts.maxAge);\n\t\t\t\tres.send(content);\n\t\t\t});\n\t\t} else {\n\t\t\tmodule(id, opts, function(err, content, modified) {\n\t\t\t\tif (err) return 'ENOENT' === err.code ? next() : next(err);\n\t\t\t\tres.set('Content-Type', 'application/javascript');\n\t\t\t\tres.set('Last-Modified', modified.toGMTString());\n\t\t\t\tres.set('Cache-Control', 'public, max-age=' + opts.maxAge);\n\t\t\t\tres.send(content);\n\t\t\t});\n\t\t}\n\t};\n}\n\nexports.middleware = middleware;\nexports.dependencies = dependencies;\nexports.modules = modules;\nexports.module = module;\nexports.getOptions = getOptions;\n"],[0,"\n"]],"start1":2183,"start2":2183,"length1":4649,"length2":3472}]],"length":5655,"saved":false}
{"ts":1351369829638,"patch":[[{"diffs":[[0," false;\n"],[1,"  opts.bundles = opts.bundles || false;\n"],[0,"\topts.ma"]],"start1":971,"start2":971,"length1":16,"length2":56}]],"length":5695,"saved":false}
{"ts":1351370150630,"patch":[[{"diffs":[[0," false;\n"],[-1,"  "],[1,"\t"],[0,"opts.bun"]],"start1":971,"start2":971,"length1":18,"length2":17},{"diffs":[[0,"rn opts;\n}\n\n"],[1,"/**\n * Prints the code for the bundles, including all dependencies\n **/\nfunction bundles(opts, next) {\n                \n}\n\n"],[0,"/**\n * Print"]],"start1":1250,"start2":1250,"length1":24,"length2":147},{"diffs":[[0,"(opts);\n"],[1,"              "],[0,"  if ('b"]],"start1":1585,"start2":1585,"length1":16,"length2":30},{"diffs":[[0,"array\n *"],[1,"              "],[0,"  id can"]],"start1":3383,"start2":3383,"length1":16,"length2":30}]],"length":5845,"saved":false}
{"ts":1351370475207,"patch":[[{"diffs":[[0,"next) {\n"],[-1,"                "],[1,"\topts = getOptions(opts);\n\tvar bundles = opts.bundles;"],[0,"\n}\n\n/**\n"]],"start1":1357,"start2":1357,"length1":32,"length2":70},{"diffs":[[0,"(opts);\n"],[-1,"                "],[1,"\t"],[0,"if ('bun"]],"start1":1623,"start2":1623,"length1":32,"length2":17},{"diffs":[[0,"(0),"],[-1," error,"],[0,"\n\t\tl"]],"start1":2455,"start2":2455,"length1":15,"length2":8},{"diffs":[[0,"y\n *"],[-1,"                "],[1,"\t\t\t\t"],[0,"id c"]],"start1":3403,"start2":3403,"length1":24,"length2":12}]],"length":5849,"saved":false}
{"ts":1351372349829,"patch":[[{"diffs":[[0,".bundles"],[1,", stack = Object.keys(bundles), bundle, name,\n\t\tinclude, exclude, depends, result = {};\n\n\tfunction loop() {\n\t\tif (!stack.length) return done();\n\t\tname = stack.pop();\n\t\tinclude = bundles[name].modules;\n\t\texclude = bundles[name].exclude;\n\t\tdependencies(exclude, opts, function(err, exclude) {\n\t\t\tif (err) { return next(err); }\n\t\t\tdependencies(include, opts, function(err, include) {\n\t\t\t\tdepends = include.filter(function(id) { return !~exclude.indexOf(id); });\n\t\t\t\tinclude = include.filter(function(id) { return ~exclude.indexOf(id); });\n\t\t\t\tloop();\n\t\t\t});\n\t\t});\n\t}\n\tloop();\n\t\t\n\t\t\n\tfor (name in bundles) {\n\t{\n\t\t\tlib: {\n\t\t\t\tsrc: [ 'lib' ],\n\t\t\t\tdest: 'public/module/lib.package.js'\n\t\t\t},\n\t\t\terror: {\n\t\t\t\tsrc: [ 'require', 'view/error' ],\n\t\t\t\tdest: 'public/module/error.package.js'\n\t\t\t},\n\t\t\tclient: {\n\t\t\t\tsrc: [ 'require', 'client', 'view/locale/en.json' ],\n\t\t\t\texclude: [ 'lib' ],\n\t\t\t\tdest: 'public/module/client.package.js'\n\t\t\t},\n\t\t\t'report-pdf': {\n\t\t\t\tsrc: [ 'require', 'view/report/report-pdf', 'view/locale/en.json' ],\n\t\t\t\tdest: 'public/module/report-pdf.package.js'\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar done = this.async(), fs = require('fs'),\n\t\t\ttarget = this.target, dest = this.data.dest,\n\t\t\tsrc = this.data.src, exclude = this.data.exclude || [],\n\t\t\tmodules = require('./middleware/modules'), _ = require('underscore');\n\t\tmodules.dependencies(exclude, function(err, exclude) {\n\t\t\tif (err) { grunt.helper('error', err); return done(false); }\n\t\t\tmodules.dependencies(src, function(err, list) {\n\t\t\t\tif (err) { grunt.helper('error', err); return done(false); }\n\t\t\t\tlist = _.difference(list, exclude);\n\t\t\t\tgrunt.verbose.writeln('Packaging:\\n\\t' + list.join('\\n\\t'));\n\t\t\t\tmodules.modules(list, function(err, code, mtime) {\n\t\t\t\t\tif (err) { grunt.helper('error', err); return done(false); }\n\t\t\t\t\tgrunt.file.write(dest, code);\n\t\t\t\t\tgrunt.log.writeln('File \"' + dest + '\" created.');\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t});\n\t\t})"],[0,";\n}\n\n/**"]],"start1":1410,"start2":1410,"length1":16,"length2":1908}]],"length":7741,"saved":false}
{"ts":1351372477213,"patch":[[{"diffs":[[0,"result ="],[1," {}, map ="],[0," {};\n\n\tf"]],"start1":1493,"start2":1493,"length1":16,"length2":26},{"diffs":[[0,"Of(id); });\n"],[1,"\t\t\t\tresult[name] = { modules:include, dependencies:depends };\n"],[0,"\t\t\t\tloop();\n"]],"start1":1952,"start2":1952,"length1":24,"length2":86}]],"length":7813,"saved":false}
{"ts":1351372516188,"patch":[[{"diffs":[[0,"ends };\n"],[1,"\t\t\t\tinclude.forEach(function(id) { map[id] = name; });\n"],[0,"\t\t\t\tloop"]],"start1":2018,"start2":2018,"length1":16,"length2":71}]],"length":7868,"saved":false}
{"ts":1351372706139,"patch":[[{"diffs":[[0,"s), "],[-1,"bundle, "],[0,""],[1,""],[0,"name"]],"start1":1446,"start2":1446,"length1":16,"length2":8},{"diffs":[[0," = {};\n\n"],[1,"\tfunction done() {\n\t\tfor (name in result) {\n\t\t\tresult.dependencies = result.dependencies.map(function(id) {\n\t\t\t\treturn map[id] || id;\n\t\t\t});\n\t\t}\n\t}\n\n"],[0,"\tfunctio"]],"start1":1501,"start2":1501,"length1":16,"length2":165},{"diffs":[[0,"\t\t\t\t"],[-1,"result[name] = { modules:include, dependencies:depends };\n\t\t\t\tinclude.forEach(function(id) { map[id] = name; });\n\t\t\t\tloop();\n\t\t\t});\n\t\t});\n\t}\n\tloop();\n\t\t\n\t\t\n\tfor (name in bundles) {\n\t{\n\t\t\tlib: {\n\t\t\t\tsrc: [ 'lib' ],\n\t\t\t\tdest: 'public/module/lib.package.js'\n\t\t\t},\n\t\t\terror: {\n\t\t\t\tsrc: [ 'require', 'view/error' ],\n\t\t\t\tdest: 'public/module/error.package.js'\n\t\t\t},\n\t\t\tclient: {\n\t\t\t\tsrc: [ 'require', 'client', 'view/locale/en.json' ],\n\t\t\t\texclude: [ 'lib' ],\n\t\t\t\tdest: 'public/module/client.package.js'\n\t\t\t},\n\t\t\t'report-pdf': {\n\t\t\t\tsrc: [ 'require', 'view/report/report-pdf', 'view/locale/en.json' ],\n\t\t\t\tdest: 'public/module/report-pdf.package.js'\n\t\t\t}\n\t\t}\n\t\t\n\t\tvar done = this.async(), fs = require('fs'),\n\t\t\ttarget = this.target, dest = this.data.dest,\n\t\t\tsrc = this.data.src, exclude = this.data.exclude || [],\n\t\t\tmodules = require('./middleware/modules'), _ = require('underscore');\n\t\tmodules.dependencies(exclude, function(err, exclude) {\n\t\t\tif (err) { grunt.helper('error', err); return done(false);"],[1,"include.forEach(function(id) { map[id] = name; });\n\t\t\t\tresult[name] = { modules:include, dependencies:depends"],[0," }"],[1,";"],[0,"\n\t\t\t"],[-1,"modules.dependencies(src, function(err, list) {\n\t\t\t\tif (err) { grunt.helper('error', err); return done(false); }\n\t\t\t\tlist = _.difference(list, exclude);\n\t\t\t\tgrunt.verbose.writeln('Packaging:\\n\\t' + list.join('\\n\\t'));\n\t\t\t\tmodules.modules(list, function(err, code, mtime) {\n\t\t\t\t\tif (err) { grunt.helper('error', err); return done(false); }\n\t\t\t\t\tgrunt.file.write(dest, code);\n\t\t\t\t\tgrunt.log.writeln('File \"' + dest + '\" created.');\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t});\n\t\t}"],[1,"\tloop();\n\t\t\t});\n\t\t});\n\t}\n\tloop("],[0,");\n}"]],"start1":2105,"start2":2105,"length1":1476,"length2":155}]],"length":6688,"saved":false}
{"ts":1351372732601,"patch":[[{"diffs":[[0,"ap[id] ="],[1," map[id] ||"],[0," name; }"]],"start1":2141,"start2":2141,"length1":16,"length2":27}]],"length":6699,"saved":false}
{"ts":1351372913467,"patch":[[{"diffs":[[0,"\n\t\t\t"],[-1,"result.dependencies = "],[1,"var deps = {};\n\t\t\t"],[0,"resu"]],"start1":1552,"start2":1552,"length1":30,"length2":26},{"diffs":[[0,"dencies."],[-1,"map"],[1,"forEach"],[0,"(functio"]],"start1":1586,"start2":1586,"length1":19,"length2":23},{"diffs":[[0,") {\n\t\t\t\t"],[-1,"return "],[1,"deps["],[0,"map[id] "]],"start1":1613,"start2":1613,"length1":23,"length2":21},{"diffs":[[0,"d] || id"],[1,"] = 1"],[0,";\n\t\t\t});"]],"start1":1631,"start2":1631,"length1":16,"length2":21},{"diffs":[[0,"= 1;\n\t\t\t});\n"],[1,"\t\t\tresult.dependencies = Object.keys(deps);\n"],[0,"\t\t}\n\t}\n\n\tfun"]],"start1":1641,"start2":1641,"length1":24,"length2":68}]],"length":6746,"saved":false}
{"ts":1351373027940,"patch":[[{"diffs":[[0,"\tvar"],[-1," bundles = opts.bundles,"],[0," sta"]],"start1":1391,"start2":1391,"length1":32,"length2":8},{"diffs":[[0,"ct.keys("],[1,"opts."],[0,"bundles)"]],"start1":1408,"start2":1408,"length1":16,"length2":21},{"diffs":[[0,"on(id) {"],[-1,"\n\t\t\t\t"],[1," "],[0,"deps[map"]],"start1":1589,"start2":1589,"length1":21,"length2":17},{"diffs":[[0,"id] = 1;"],[-1,"\n\t\t\t"],[1," "],[0,"});\n\t\t\tr"]],"start1":1614,"start2":1614,"length1":20,"length2":17},{"diffs":[[0,"();\n\t\tinclude = "],[1,"opts."],[0,"bundles[name].mo"]],"start1":1752,"start2":1752,"length1":32,"length2":37},{"diffs":[[0,"clude = "],[1,"opts."],[0,"bundles["]],"start1":1800,"start2":1800,"length1":16,"length2":21}]],"length":6730,"saved":false}
{"ts":1351373140195,"patch":[[{"diffs":[[0,",\n\t\t"],[-1,"include, exclude, "],[0,"depe"]],"start1":1435,"start2":1435,"length1":26,"length2":8},{"diffs":[[0,"s);\n\t\t}\n"],[1,"\t\tnext(null, result);\n"],[0,"\t}\n\n\tfun"]],"start1":1649,"start2":1649,"length1":16,"length2":38},{"diffs":[[0,"op();\n\t\t"],[1,"var "],[0,"include "]],"start1":1754,"start2":1754,"length1":16,"length2":20},{"diffs":[[0,".modules"],[-1,";\n"],[1,",\n\t"],[0,"\t\texclud"]],"start1":1794,"start2":1794,"length1":18,"length2":19}]],"length":6739,"saved":false}
{"ts":1351373224047,"patch":[[{"diffs":[[0," include) {\n"],[1,"\t\t\t\tif (err) { return next(err); }\n"],[0,"\t\t\t\tdepends "]],"start1":1978,"start2":1978,"length1":24,"length2":59}]],"length":6774,"saved":false}
{"ts":1351373285519,"patch":[[{"diffs":[[0,",\n\t\t"],[-1,"depends, "],[0,"resu"]],"start1":1435,"start2":1435,"length1":17,"length2":8},{"diffs":[[0,"; }\n\t\t\t\t"],[1,"var "],[0,"depends "]],"start1":2012,"start2":2012,"length1":16,"length2":20}]],"length":6769,"saved":false}
{"ts":1351373371383,"patch":[[{"diffs":[[0,"s), "],[-1,"name,\n\t\t"],[0,"resu"]],"start1":1427,"start2":1427,"length1":16,"length2":8},{"diffs":[[0,"\n\t\tfor ("],[1,"var "],[0,"name in "]],"start1":1473,"start2":1473,"length1":16,"length2":20},{"diffs":[[0," = {};\n\t\t\tresult"],[1,"[name]"],[0,".dependencies.fo"]],"start1":1514,"start2":1514,"length1":32,"length2":38},{"diffs":[[0,"\t\tresult"],[1,"[name]"],[0,".depende"]],"start1":1603,"start2":1603,"length1":16,"length2":22},{"diffs":[[0,"ne();\n\t\t"],[1,"var "],[0,"name = s"]],"start1":1731,"start2":1731,"length1":16,"length2":20},{"diffs":[[0,"ck.pop()"],[-1,";\n\t\tvar "],[1,",\n\t\t\t"],[0,"include "]],"start1":1753,"start2":1753,"length1":24,"length2":21}]],"length":6778,"saved":false}
{"ts":1351376433681,"patch":[[{"diffs":[[0,"| __dirname + '/"],[-1,"requir"],[1,"bundl"],[0,"e';\n\topts.transl"]],"start1":1147,"start2":1147,"length1":38,"length2":37},{"diffs":[[0,"undleMap"],[1," = readFile()"],[0,",\n\t\tstac"]],"start1":1459,"start2":1459,"length1":16,"length2":29}]],"length":6905,"saved":false}
{"ts":1351376528237,"patch":[[{"diffs":[[0,"e';\n"],[-1,"\topts.map.bundle = opts.map.require || __dirname + '/bundle';\n"],[0,"\topt"]],"start1":1106,"start2":1106,"length1":70,"length2":8},{"diffs":[[0,"ions(opts);\n"],[1,"\tvar uri = getUri(id, opts);\n"],[0,"\tif ('bundle"]],"start1":2613,"start2":2613,"length1":24,"length2":53},{"diffs":[[0,"= id"],[-1," && opts.bundles"],[0,") { "]],"start1":2671,"start2":2671,"length1":24,"length2":8},{"diffs":[[0," return bundles("],[1,"uri, "],[0,"opts, next); }\n\t"]],"start1":2678,"start2":2678,"length1":32,"length2":37},{"diffs":[[0,"; }\n"],[-1,"\tvar uri = getUri(id, opts);\n"],[0,"\tfs."]],"start1":2710,"start2":2710,"length1":37,"length2":8}]],"length":6832,"saved":false}
{"ts":1351376916419,"patch":[[{"diffs":[[0,");\n\t"],[-1,"if ('bundles' === id) { return bundles(uri, opts, next); }\n\t"],[0,""],[1,""],[0,"fs.s"]],"start1":2651,"start2":2651,"length1":68,"length2":8},{"diffs":[[0,"if ("],[-1,"id !== "],[1,"'bundles' === id) { \n\t\t\t\tbundles(content, opts, next);\n\t\t\t} else {\n\t\t\t\tif ("],[0,"'req"]],"start1":2804,"start2":2804,"length1":15,"length2":83},{"diffs":[[0,"require'"],[1," !== id"],[0,") {\n"],[1,"\t"],[0,"\t\t\t\tcont"]],"start1":2884,"start2":2884,"length1":20,"length2":28},{"diffs":[[0," opts);\n"],[1,"\t"],[0,"\t\t\t\tcont"]],"start1":2945,"start2":2945,"length1":16,"length2":17},{"diffs":[[0," +\n\t\t\t\t\t"],[1,"\t"],[0,"',functi"]],"start1":2998,"start2":2998,"length1":16,"length2":17},{"diffs":[[0,"\\n';\n\t\t\t"],[1,"\t"],[0,"}\n"],[1,"\t"],[0,"\t\t\tif (o"]],"start1":3062,"start2":3062,"length1":18,"length2":20},{"diffs":[[0,") {\n\t\t\t\t"],[1,"\t"],[0,"opts.com"]],"start1":3094,"start2":3094,"length1":16,"length2":17},{"diffs":[[0,"ent) {\n\t\t\t\t\t"],[1,"\t"],[0,"if (err) ret"]],"start1":3144,"start2":3144,"length1":24,"length2":25},{"diffs":[[0," next(err);\n"],[1,"\t"],[0,"\t\t\t\t\tnext(nu"]],"start1":3172,"start2":3172,"length1":24,"length2":25},{"diffs":[[0,"e);\n\t\t\t\t"],[1,"\t"],[0,"});\n"],[1,"\t"],[0,"\t\t\t} els"]],"start1":3219,"start2":3219,"length1":20,"length2":22},{"diffs":[[0,"\t\t\t} else {\n"],[1,"\t"],[0,"\t\t\t\tnext(nul"]],"start1":3233,"start2":3233,"length1":24,"length2":25},{"diffs":[[0,"mtime);\n"],[1,"\t\t\t\t}\n"],[0,"\t\t\t}\n\t\t}"]],"start1":3275,"start2":3275,"length1":16,"length2":22}]],"length":6864,"saved":false}
{"ts":1351376966419,"patch":[[{"diffs":[[0,"'bundles"],[1,".json"],[0,"' === id"]],"start1":2808,"start2":2808,"length1":16,"length2":21},{"diffs":[[0,"bundles("],[1,"JSON.parse("],[0,"content"],[1,")"],[0,", opts, "]],"start1":2838,"start2":2838,"length1":23,"length2":35}]],"length":6881,"saved":false}
{"ts":1351377071782,"patch":[[{"diffs":[[0,"bundles("],[1,"bundleMap, mtime, "],[0,"opts, ne"]],"start1":1343,"start2":1343,"length1":16,"length2":34},{"diffs":[[0,"var "],[-1,"bundleMap = readFile(),\n\t\t"],[0,"stac"]],"start1":1410,"start2":1410,"length1":34,"length2":8},{"diffs":[[0,"+ ');\\n'"],[1,", mtime"],[0,");\n\t}\n\n\t"]],"start1":1730,"start2":1730,"length1":16,"length2":23},{"diffs":[[0,"ontent),"],[1," stat.mtime,"],[0," opts, n"]],"start1":2857,"start2":2857,"length1":16,"length2":28}]],"length":6892,"saved":false}
{"ts":1351377103501,"patch":[[{"diffs":[[0,";\n\t\t}\n\t\t"],[-1,"next(null,"],[1,"var content ="],[0," 'define"]],"start1":1665,"start2":1665,"length1":26,"length2":29},{"diffs":[[0,"+ ');\\n'"],[1,";\n\t\tnext(null, content"],[0,", mtime)"]],"start1":1733,"start2":1733,"length1":16,"length2":38}]],"length":6917,"saved":false}
{"ts":1351377453335,"patch":[[{"diffs":[[0,"p[name]."],[-1,"exclude"],[1,"dependencies"],[0,";\n\t\tdepe"]],"start1":1917,"start2":1917,"length1":23,"length2":28}]],"length":6922,"saved":false}
{"ts":1351400350396,"patch":[[{"diffs":[[0,".js');\n\t"],[-1,""],[0,""],[1,"// require and bundles.json can be in forbidden places\n\tif ('bundles.json' === id || 'require' === id) { return uri; }\n\t"],[0,"for (f ="]],"start1":644,"start2":644,"length1":16,"length2":136},{"diffs":[[0,"Map,"],[-1," mtime,"],[0," opt"]],"start1":1477,"start2":1477,"length1":15,"length2":8},{"diffs":[[0,"ndleMap)"],[1,".reverse()"],[0,", result"]],"start1":1549,"start2":1549,"length1":16,"length2":26},{"diffs":[[0,"}\n\t\t"],[-1,"var content = 'define.bundle.map(' + JSON.stringify(result) + ');\\n';\n\t\tnext(null, content, mtime"],[1,"next(null, result"],[0,");\n\t"]],"start1":1792,"start2":1792,"length1":105,"length2":25},{"diffs":[[0,"ndencies"],[-1,""],[0,""],[1," || []"],[0,";\n\t\tdepe"]],"start1":1972,"start2":1972,"length1":16,"length2":22},{"diffs":[[0," return "],[-1,"!"],[0,"~exclude"]],"start1":2215,"start2":2215,"length1":17,"length2":16},{"diffs":[[0,"on(id) { return "],[1,"!"],[0,"~exclude.indexOf"]],"start1":2284,"start2":2284,"length1":32,"length2":33},{"diffs":[[0,"[id] || "],[1,"("],[0,"name"],[1," + '.bundle')"],[0,"; });\n\t\t"]],"start1":2375,"start2":2375,"length1":20,"length2":34},{"diffs":[[0,"t), "],[-1,"stat.mtime, opts, next"],[1,"opts, function(err, content) {\n\t\t\t\t\tif (err) { return next(err); }\n\t\t\t\t\tcontent = 'define.bundle.map(' + JSON.stringify(content) + ');\\n';\n\t\t\t\t\tnext(null, content, stat.mtime);\n\t\t\t\t}"],[0,");\n\t"]],"start1":2955,"start2":2955,"length1":30,"length2":190},{"diffs":[[0,"array\n *"],[-1,"\t\t\t\t"],[1,"  "],[0,"id can b"]],"start1":4695,"start2":4695,"length1":20,"length2":18},{"diffs":[[0,"eplace(/"],[-1,"\\w"],[1,"[^\\/]"],[0,"+$/, id)"]],"start1":5120,"start2":5120,"length1":18,"length2":21},{"diffs":[[0,"module;\n"],[1,"exports.bundles = bundles;\n"],[0,"exports."]],"start1":7104,"start2":7104,"length1":16,"length2":43},{"diffs":[[0,"ptions;\n"],[-1,"\n"]],"start1":7164,"start2":7164,"length1":9,"length2":8}]],"length":7172,"saved":false}
{"contributors":[],"silentsave":false,"ts":1358199152011,"patch":[[{"diffs":[[0,"Uri(id, opts"],[-1,""],[0,""],[1,", next"],[0,") {\n\tvar uri"]],"start1":504,"start2":504,"length1":24,"length2":30},{"diffs":[[0,"uri)"],[-1," + (extexp.test(uri) ? '' : '.js')"],[0,";\n\t/"]],"start1":617,"start2":617,"length1":42,"length2":8},{"diffs":[[0," require"],[-1," and"],[1,","],[0," bundles"]],"start1":626,"start2":626,"length1":20,"length2":17},{"diffs":[[0,"les.json"],[1,", and mapped modules"],[0," can be "]],"start1":640,"start2":640,"length1":16,"length2":36},{"diffs":[[0,"on' "],[-1,"="],[1,"!"],[0,"== id "],[-1,"||"],[1,"&&"],[0," 're"]],"start1":712,"start2":712,"length1":17,"length2":17},{"diffs":[[0,"re' "],[1,"!"],[0,"=="],[-1,"="],[0," "],[1,"id && !opts.map["],[0,"id"],[1,"]"],[0,") {"],[-1," return uri; "],[1,"\n\t\tif ('..' === path.relative(opts.root, uri).slice(0, 2)) {\n\t\t\treturn next(new Error('Forbidden'), '');\n\t\t"],[0,"}\n"],[1,"\t"],[0,"\tfor"]],"start1":732,"start2":732,"length1":32,"length2":144},{"diffs":[[0," ff; ++f) {\n"],[1,"\t"],[0,"\t\tforbid = o"]],"start1":888,"start2":888,"length1":24,"length2":25},{"diffs":[[0,"orbid[f];\n\t\t"],[1,"\t"],[0,"if (uri.slic"]],"start1":918,"start2":918,"length1":24,"length2":25},{"diffs":[[0,"id) "],[1,"{\n\t\t\t\t"],[0,"return "],[-1,"'';\n\t}\n\treturn uri"],[1,"next(new Error('Forbidden'), '');\n\t\t\t}\n\t\t}\n\t}\n\tfs.stat(uri, function(err, stats) {\n\t\tif (err) {\n\t\t\treturn fs.exists(uri + '.js', function(exists) {\n\t\t\t\treturn next(null, uri + (exists ? '.js' : ''));\n\t\t\t});\n\t\t}\n\t\tif (stats.isDirectory()) {\n\t\t\treturn fs.exists(uri + '/index.js', function(exists) {\n\t\t\t\treturn next(null, uri + (exists ? '/index.js' : ''));\n\t\t\t});\n\t\t}\n\t\treturn next(null, uri);\n\t})"],[0,";\n}\n"]],"start1":971,"start2":971,"length1":33,"length2":417},{"diffs":[[0,".map || {};\n"],[1,"\topts.map.require = opts.map.require || __dirname + '/require';\n"],[0,"\topts.transl"]],"start1":1641,"start2":1641,"length1":24,"length2":88},{"diffs":[[0,"ct.keys("],[-1,"opts."],[0,"bundle"],[-1,"s"],[1,"Map"],[0,").revers"]],"start1":2026,"start2":2026,"length1":28,"length2":25},{"diffs":[[0,"}\n\t\t"],[-1,"var content ="],[1,"next(null,"],[0," res"]],"start1":2279,"start2":2279,"length1":21,"length2":18},{"diffs":[[0,"\t\tinclude = "],[-1,"opts."],[0,"bundle"],[-1,"s"],[1,"Map"],[0,"[name].modul"]],"start1":2389,"start2":2389,"length1":36,"length2":33},{"diffs":[[0,"clude = "],[-1,"opts."],[0,"bundle"],[-1,"s"],[1,"Map"],[0,"[name].d"]],"start1":2431,"start2":2431,"length1":28,"length2":25},{"diffs":[[0,"r); }\n\t\t"],[-1,"next(null, result"],[0,""],[1,""],[0,"\tdepende"]],"start1":2558,"start2":2558,"length1":33,"length2":16},{"diffs":[[0,"opts);\n\t"],[-1,"var uri = "],[0,"getUri(i"]],"start1":3197,"start2":3197,"length1":26,"length2":16},{"diffs":[[0,"id, opts"],[-1,");\n"],[1,", function(err, uri) {\n\t"],[0,"\tfs.stat"]],"start1":3212,"start2":3212,"length1":19,"length2":40},{"diffs":[[0,"rr, stat) {\n"],[1,"\t"],[0,"\t\tif (err) r"]],"start1":3268,"start2":3268,"length1":24,"length2":25},{"diffs":[[0,"t) {\n\t\t\tif (err)"],[1," {"],[0," return next(err"]],"start1":3275,"start2":3275,"length1":32,"length2":34},{"diffs":[[0,"xt(err);"],[-1,"\n"],[1," }\n\t"],[0,"\t\tfs.rea"]],"start1":3303,"start2":3303,"length1":17,"length2":20},{"diffs":[[0,", content) {\n\t\t\t"],[1,"\t"],[0,"if (err) return "]],"start1":3354,"start2":3354,"length1":32,"length2":33},{"diffs":[[0,"t(err);\n"],[1,"\t"],[0,"\t\t\tif ('"]],"start1":3390,"start2":3390,"length1":16,"length2":17},{"diffs":[[0," id) { \n"],[1,"\t"],[0,"\t\t\t\tbund"]],"start1":3424,"start2":3424,"length1":16,"length2":17},{"diffs":[[0," content) {\n"],[1,"\t"],[0,"\t\t\t\t\tif (err"]],"start1":3485,"start2":3485,"length1":24,"length2":25},{"diffs":[[0,"rr); }\n\t\t\t\t\t"],[1,"\t"],[0,"content = 'd"]],"start1":3527,"start2":3527,"length1":24,"length2":25},{"diffs":[[0,");\\n';\n\t\t\t\t\t"],[1,"\t"],[0,"next(null, c"]],"start1":3600,"start2":3600,"length1":24,"length2":25},{"diffs":[[0,"e);\n\t\t\t\t"],[1,"\t"],[0,"});\n"],[1,"\t"],[0,"\t\t\t} els"]],"start1":3642,"start2":3642,"length1":20,"length2":22},{"diffs":[[0," else {\n\t\t\t\t"],[1,"\t"],[0,"if ('require"]],"start1":3660,"start2":3660,"length1":24,"length2":25},{"diffs":[[0,"' !== id) {\n"],[1,"\t"],[0,"\t\t\t\t\tcontent"]],"start1":3685,"start2":3685,"length1":24,"length2":25},{"diffs":[[0,"opts);\n\t\t\t\t\t"],[1,"\t"],[0,"content = 'd"]],"start1":3741,"start2":3741,"length1":24,"length2":25},{"diffs":[[0,"y(id) +\n"],[1,"\t"],[0,"\t\t\t\t\t\t',"]],"start1":3789,"start2":3789,"length1":16,"length2":17},{"diffs":[[0,"n';\n\t\t\t\t"],[1,"\t"],[0,"}\n"],[1,"\t"],[0,"\t\t\t\tif ("]],"start1":3860,"start2":3860,"length1":18,"length2":20},{"diffs":[[0,"compress) {\n"],[1,"\t"],[0,"\t\t\t\t\topts.co"]],"start1":3885,"start2":3885,"length1":24,"length2":25},{"diffs":[[0,"ontent) {\n\t\t\t\t\t\t"],[1,"\t"],[0,"if (err) return "]],"start1":3941,"start2":3941,"length1":32,"length2":33},{"diffs":[[0," next(err);\n"],[1,"\t"],[0,"\t\t\t\t\t\tnext(n"]],"start1":3973,"start2":3973,"length1":24,"length2":25},{"diffs":[[0,"at.mtime);\n\t\t\t\t\t"],[1,"\t"],[0,"});\n"],[1,"\t"],[0,"\t\t\t\t} else {\n\t\t\t"]],"start1":4014,"start2":4014,"length1":36,"length2":38},{"diffs":[[0,"\t\t\t} else {\n"],[1,"\t"],[0,"\t\t\t\t\tnext(nu"]],"start1":4037,"start2":4037,"length1":24,"length2":25},{"diffs":[[0,"tat.mtime);\n"],[1,"\t"],[0,"\t\t\t\t}\n\t\t\t}\n\t"]],"start1":4076,"start2":4076,"length1":24,"length2":25},{"diffs":[[0,";\n\t\t\t\t\t}\n\t\t\t"],[-1,"}"],[1,"\t}\n\t\t\t});"],[0,"\n\t\t});\n\t});\n"]],"start1":4086,"start2":4086,"length1":25,"length2":33},{"diffs":[[0,"op()"],[-1,", uri = "],[1,";\n\t\t"],[0,"getU"]],"start1":5989,"start2":5989,"length1":16,"length2":12},{"diffs":[[0,"id, opts"],[-1,");\n"],[1,", function(err, uri) {\n\t"],[0,"\t\tfs.rea"]],"start1":6004,"start2":6004,"length1":19,"length2":40},{"diffs":[[0,", content) {\n\t\t\t"],[1,"\t"],[0,"if (err) {\n\t\t\t\ti"]],"start1":6075,"start2":6075,"length1":32,"length2":33},{"diffs":[[0,"\tif (err) {\n"],[1,"\t"],[0,"\t\t\t\tif ('ENO"]],"start1":6091,"start2":6091,"length1":24,"length2":25},{"diffs":[[0,"ode) {\n\t\t\t\t\t"],[1,"\t"],[0,"list.splice("]],"start1":6130,"start2":6130,"length1":24,"length2":25},{"diffs":[[0,"d), 1);\n"],[1,"\t"],[0,"\t\t\t\t\tret"]],"start1":6169,"start2":6169,"length1":16,"length2":17},{"diffs":[[0,"loop();\n\t\t\t\t"],[1,"\t"],[0,"} else { ret"]],"start1":6190,"start2":6190,"length1":24,"length2":25},{"diffs":[[0,"err); }\n"],[1,"\t"],[0,"\t\t\t}\n\t\t\t"],[1,"\t"],[0,"content "]],"start1":6224,"start2":6224,"length1":24,"length2":26},{"diffs":[[0,", opts);\n\t\t\t"],[1,"\t"],[0,"var matches "]],"start1":6278,"start2":6278,"length1":24,"length2":25},{"diffs":[[0,"eqexp),\n"],[1,"\t"],[0,"\t\t\t\tm, m"]],"start1":6320,"start2":6320,"length1":16,"length2":17},{"diffs":[[0,"gth;\n\t\t\t"],[1,"\t"],[0,"for (m ="]],"start1":6363,"start2":6363,"length1":16,"length2":17},{"diffs":[[0," mm; ++m) {\n"],[1,"\t"],[0,"\t\t\t\tvar rid "]],"start1":6387,"start2":6387,"length1":24,"length2":25},{"diffs":[[0,"], id);\n\t\t\t\t"],[1,"\t"],[0,"if (!~list.i"]],"start1":6447,"start2":6447,"length1":24,"length2":25},{"diffs":[[0,"xOf(rid)) {\n"],[1,"\t"],[0,"\t\t\t\t\tlist[li"]],"start1":6475,"start2":6475,"length1":24,"length2":25},{"diffs":[[0,"\t\t\t\t"],[1,"\t"],[0,"}\n"],[1,"\t"],[0,"\t\t\t}\n"],[1,"\t"],[0,"\t\t\tl"]],"start1":6540,"start2":6540,"length1":15,"length2":18},{"diffs":[[0,"loop();\n"],[1,"\t\t\t});\n"],[0,"\t\t});\n\t}"]],"start1":6557,"start2":6557,"length1":16,"length2":23}]],"length":7745,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366735172610,"patch":[[{"diffs":[[0,"(name, uri, "],[-1,"content"],[1,"buffer"],[0,", opts) {\n\tv"]],"start1":168,"start2":168,"length1":31,"length2":30},{"diffs":[[0,"(name, uri, "],[-1,"content"],[1,"buffer"],[0,", opts);\n\tif"]],"start1":281,"start2":281,"length1":31,"length2":30},{"diffs":[[0," return "],[-1,"content"],[1,"buffer.toString('utf8')"],[0,";\n\tif ('"]],"start1":326,"start2":326,"length1":23,"length2":39},{"diffs":[[0,"s = ' + "],[-1,"content"],[1,"buffer.toString('utf8')"],[0,";\n\tretur"]],"start1":401,"start2":401,"length1":23,"length2":39},{"diffs":[[0,"(content"],[1,".toString('utf8')"],[0,"); // ex"]],"start1":478,"start2":478,"length1":16,"length2":33},{"diffs":[[0,", forbid"],[1,", forbidden"],[0,";\n\turi ="]],"start1":623,"start2":623,"length1":16,"length2":27},{"diffs":[[0,"[f];\n\t\t\t"],[-1,"if "],[1,"forbidden = forbid.test ? forbid.test(uri) :\n\t\t\t\t"],[0,"(uri.sli"]],"start1":981,"start2":981,"length1":19,"length2":65},{"diffs":[[0," forbid)"],[-1," {\n\t\t\t\t"],[1,";\n\t\t\tif (forbidden) { "],[0,"return n"]],"start1":1070,"start2":1070,"length1":23,"length2":38},{"diffs":[[0,"'), '');"],[-1,"\n\t\t\t"],[1," "],[0,"}\n\t\t}\n\t}"]],"start1":1132,"start2":1132,"length1":20,"length2":17},{"diffs":[[0,"eadFile(uri,"],[-1," 'utf8',"],[0," function(er"]],"start1":3437,"start2":3437,"length1":32,"length2":24},{"diffs":[[0,", function(err, "],[-1,"content"],[1,"buffer"],[0,") {\n\t\t\t\tif (err)"]],"start1":3448,"start2":3448,"length1":39,"length2":38},{"diffs":[[0," next(err);\n"],[1,"\t\t\t\tvar content = buffer.toString('utf8');\n"],[0,"\t\t\t\tif ('bun"]],"start1":3493,"start2":3493,"length1":24,"length2":67},{"diffs":[[0,"nslate(id, uri, "],[-1,"content"],[1,"buffer"],[0,", opts);\n\t\t\t\t\t\tc"]],"start1":3866,"start2":3866,"length1":39,"length2":38},{"diffs":[[0,"uri,"],[-1," 'utf8',"],[0," fun"]],"start1":6199,"start2":6199,"length1":16,"length2":8},{"diffs":[[0,", function(err, "],[-1,"content"],[1,"buffer"],[0,") {\n\t\t\t\tif (err)"]],"start1":6202,"start2":6202,"length1":39,"length2":38},{"diffs":[[0,"}\n\t\t\t\t}\n\t\t\t\t"],[1,"var "],[0,"content = tr"]],"start1":6370,"start2":6370,"length1":24,"length2":28},{"diffs":[[0,"d, uri, "],[-1,"content"],[1,"buffer"],[0,", opts);"]],"start1":6407,"start2":6407,"length1":23,"length2":22}]],"length":7888,"saved":false}
{"ts":1366735212255,"patch":[[{"diffs":[[0,"ringify("],[-1,"content"],[1,"buffer"],[0,".toStrin"]],"start1":471,"start2":471,"length1":23,"length2":22}]],"length":7887,"saved":false}
{"ts":1366736324648,"patch":[[{"diffs":[[0," opts.forbid"],[1,".length"],[0,", forbid, fo"]],"start1":610,"start2":610,"length1":24,"length2":31},{"diffs":[[0,"\t\treturn"],[1," p.test ? p :"],[0," path.re"]],"start1":1932,"start2":1932,"length1":16,"length2":29}]],"length":7907,"saved":false}
